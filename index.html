<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Task Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
  *{box-sizing:border-box;margin:0;padding:0;font-family:Arial,Helvetica,sans-serif;}
  body{background:#f5f6fa;color:#333;line-height:1.5;}
  header{background:#4f6df5;color:#fff;text-align:center;padding:1rem;}
  .container{max-width:900px;margin:2rem auto;background:#fff;padding:1.2rem;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.1);}  
  /* 입력 */
  #form{display:flex;flex-wrap:wrap;gap:.6rem;margin-bottom:1.2rem;}
  #form input,#form button{padding:.55rem;border:1px solid #ccc;border-radius:4px;}
  #form input[type="color"]{padding:0;border:none;width:50px;height:42px;cursor:pointer;}
  #form button{background:#4f6df5;color:#fff;border:none;cursor:pointer;}
  #form button:hover{background:#374ec0;}
  /* 리스트 */
  ul{list-style:none;padding:0;margin:0;}
  li.task{display:grid;grid-template-columns:auto 1fr auto auto auto;gap:.5rem;align-items:center;padding:.55rem .4rem;border-bottom:1px solid #eee;}
  li.task:last-child{border-bottom:none;}
  .dot{width:14px;height:14px;border-radius:50%;display:inline-block;}
  .dates{font-size:.8rem;color:#777;}
  .done .title{text-decoration:line-through;color:#999;}
  .done .dates{color:#bbb;}
  button.small{font-size:.8rem;padding:.35rem .5rem;border:none;border-radius:4px;background:#e1e1e1;cursor:pointer;}
  button.small:hover{background:#ccc;}
  button.del{background:#f8d2d2;color:#d33;}
  button.del:hover{background:#efb5b5;}
  /* 타임라인 */
  #timelineWrap{overflow-x:auto;margin-top:2rem;border:1px solid #ddd;border-radius:6px;}
  .grid{display:grid;position:relative;}
  .dayHead{background:#fafafa;font-size:.75rem;text-align:center;border-bottom:1px solid #ddd;}
  .row{border-bottom:1px solid #f1f1f1;min-height:34px;}
  .bar{background:#4f6df5;color:#fff;font-size:.8rem;border-radius:4px;padding:.1rem .45rem;white-space:nowrap;height:22px;display:flex;align-items:center;}
  footer{text-align:center;padding:1rem;font-size:.8rem;color:#888;}
</style>
</head>
<body>
<header><h1>Task Tracker</h1></header>
<div class="container">
  <form id="form">
    <input type="text" id="title" placeholder="할 일" style="flex:1" required>
    <input type="date" id="start">
    <input type="date" id="end">
    <input type="color" id="color" value="#4f6df5">
    <button type="submit">추가</button>
  </form>

  <ul id="list"></ul>

  <h3 style="margin-top:2rem">타임라인</h3>
  <div id="timelineWrap"><div id="timeline"></div></div>
</div>
<footer>&copy; 2025</footer>

<script>
const form=document.getElementById('form');
const titleInput=document.getElementById('title');
const startInput=document.getElementById('start');
const endInput=document.getElementById('end');
const colorInput=document.getElementById('color');
const list=document.getElementById('list');
const timeline=document.getElementById('timeline');

let tasks=JSON.parse(localStorage.getItem('tasks')||'[]');

function save(){localStorage.setItem('tasks',JSON.stringify(tasks));}

function render(){
  /* 리스트 */
  list.innerHTML='';
  if(tasks.length===0){list.innerHTML='<li style="text-align:center;color:#888;padding:.8rem 0;">태스크 없음</li>';timeline.innerHTML='';return;}
  tasks.sort((a,b)=>new Date(a.start||'9999-12-31')-new Date(b.start||'9999-12-31'));
  tasks.forEach((t,i)=>{
    const li=document.createElement('li');li.className='task'+(t.done?' done':'');
    li.innerHTML=`<span class="dot" style="background:${t.color}"></span>
      <span class="title">${t.title}</span>
      <span class="dates">${t.start||''}${t.end?' → '+t.end:''}</span>
      <button class="small doneBtn" data-i="${i}">${t.done?'↺':'✔'}</button>
      <button class="small del" data-i="${i}">✖</button>`;
    list.appendChild(li);
  });
  /* 타임라인 */
  timeline.innerHTML='';
  const dayMS=86400000;
  let min=Infinity,max=-Infinity;
  tasks.forEach(t=>{const s=t.start?Date.parse(t.start):null;const e=t.end?Date.parse(t.end):null;if(s!==null)min=Math.min(min,s);if(e!==null)max=Math.max(max,e);if(s===null&&e!==null)min=Math.min(min,e);if(e===null&&s!==null)max=Math.max(max,s);});
  if(!isFinite(min)||!isFinite(max)){return;}
  const days=Math.round((max-min)/dayMS)+1,cellW=60;
  const header=document.createElement('div');header.className='grid dayHead';header.style.gridTemplateColumns=`repeat(${days},${cellW}px)`;
  for(let i=0;i<days;i++){const d=new Date(min+i*dayMS);const cell=document.createElement('div');cell.textContent=d.getDate();header.appendChild(cell);}timeline.appendChild(header);
  tasks.forEach(t=>{const row=document.createElement('div');row.className='grid row';row.style.gridTemplateColumns=`repeat(${days},${cellW}px)`;const s=t.start?Date.parse(t.start):min;const e=t.end?Date.parse(t.end):s;const sIdx=Math.round((s-min)/dayMS);const eIdx=Math.round((e-min)/dayMS);const bar=document.createElement('div');bar.className='bar';bar.style.background=t.color;bar.style.gridColumnStart=sIdx+1;bar.style.gridColumnEnd=eIdx+2;bar.textContent=t.title;row.appendChild(bar);timeline.appendChild(row);});
}

form.addEventListener('submit',e=>{
  e.preventDefault();
  const title=titleInput.value.trim();if(!title){alert('제목 입력');return;}
  let start=startInput.value,end=endInput.value;if(start&&end&&new Date(end)<new Date(start))[start,end]=[end,start];
  tasks.push({title,start,end,color:colorInput.value,done:false});
  save();titleInput.value='';startInput.value='';endInput.value='';colorInput.value='#4f6df5';render();
});

list.addEventListener('click',e=>{
  const idx=e.target.dataset.i;if(idx===undefined)return;
  if(e.target.classList.contains('del')){tasks.splice(idx,1);}else if(e.target.classList.contains('doneBtn')){tasks[idx].done=!tasks[idx].done;}
  save();render();
});

render();
</script>
</body>
</html>
